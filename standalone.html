<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>グループシステム部 イントラサイト</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            margin: 0;
            padding: 0;
        }
        #root {
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Custom icon components
        const IconCalendar = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
            <line x1="16" x2="16" y1="2" y2="6"></line>
            <line x1="8" x2="8" y1="2" y2="6"></line>
            <line x1="3" x2="21" y1="10" y2="10"></line>
          </svg>
        );

        const IconClock = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
        );

        const IconFileText = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" x2="8" y1="13" y2="13"></line>
            <line x1="16" x2="8" y1="17" y2="17"></line>
            <line x1="10" x2="8" y1="9" y2="9"></line>
          </svg>
        );

        const IconHome = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
        );

        const IconInfo = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 16v-4"></path>
            <path d="M12 8h.01"></path>
          </svg>
        );

        const IconMessageSquare = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>
        );

        const IconSearch = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.3-4.3"></path>
          </svg>
        );

        const IconMapPin = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
        );

        const IconActivity = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
          </svg>
        );

        const IconClipboard = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <rect width="14" height="18" x="5" y="3" rx="2" ry="2"></rect>
            <path d="M15 3h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-2"></path>
            <path d="M10 7H8"></path>
            <path d="M10 11H8"></path>
            <path d="M10 15H8"></path>
          </svg>
        );

        const IconHelpCircle = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <path d="M12 17h.01"></path>
          </svg>
        );

        const IconOrganization = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <rect width="18" height="18" x="3" y="3" rx="2"></rect>
            <path d="M3 9h18"></path>
            <path d="M9 21V9"></path>
          </svg>
        );

        const IconChevronDown = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="m6 9 6 6 6-6"></path>
          </svg>
        );

        const IconChevronRight = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="m9 6 6 6-6 6"></path>
          </svg>
        );

        const IconUser = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        );

        const IconAlertTriangle = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path>
            <path d="M12 9v4"></path>
            <path d="M12 17h.01"></path>
          </svg>
        );

        const IconFileDollar = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <path d="M12 18v-4"></path>
            <path d="M8 15h8"></path>
            <path d="M12 11v.01"></path>
          </svg>
        );

        const IconReceiptText = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1z"></path>
            <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path>
            <path d="M12 17.5v-11"></path>
          </svg>
        );

        const IconLink = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
          </svg>
        );

        const IconExternalLink = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
            <polyline points="15 3 21 3 21 9"></polyline>
            <line x1="10" x2="21" y1="14" y2="3"></line>
          </svg>
        );

        const IconServer = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect>
            <rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect>
            <line x1="6" y1="6" x2="6.01" y2="6"></line>
            <line x1="6" y1="18" x2="6.01" y2="18"></line>
          </svg>
        );

        const IconTool = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
          </svg>
        );

        const IconGraduationCap = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M22 10v6M2 10l10-5 10 5-10 5z"></path>
            <path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5"></path>
          </svg>
        );

        const IconMoreHorizontal = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <circle cx="12" cy="12" r="1"></circle>
            <circle cx="19" cy="12" r="1"></circle>
            <circle cx="5" cy="12" r="1"></circle>
          </svg>
        );

        const IconImprovement = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="m18 7 4 2v11a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9l4-2"></path>
            <path d="M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4"></path>
            <path d="M18 22V5l-6-3-6 3v17"></path>
            <path d="M12 7v5"></path>
            <path d="M10 9h4"></path>
          </svg>
        );

        const IconNewspaper = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2"></path>
            <path d="M18 14h-8"></path>
            <path d="M15 18h-5"></path>
            <path d="M10 6h8v4h-8V6Z"></path>
          </svg>
        );

        const IconDirector = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
        );

        const IconSectionManager = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <circle cx="12" cy="8" r="5"></circle>
            <path d="M20 21a8 8 0 1 0-16 0"></path>
            <path d="M12 16v-3"></path>
            <path d="M8 13h8"></path>
          </svg>
        );

        const IconManager = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        );

        const IconTeam = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
        );

        const IconPdf = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <path d="M9 15v-6h3a2 2 0 0 1 0 4h-3"></path>
            <path d="M14 13h1a2 2 0 0 1 2 2v0a2 2 0 0 1-2 2h-1"></path>
            <path d="M9 19h4"></path>
          </svg>
        );

        const IconChairs = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <rect x="4" y="2" width="6" height="12" rx="1"></rect>
            <rect x="14" y="2" width="6" height="12" rx="1"></rect>
            <path d="M4 22h16"></path>
            <path d="M7 14v8"></path>
            <path d="M17 14v8"></path>
          </svg>
        );

        const IconGridIcon = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
        );

        const IconSettings = (props) => (
          <svg xmlns="http://www.w3.org/2000/svg" width={props.size || 24} height={props.size || 24} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={props.className}>
            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        );

        function DepartmentIntranet() {
          const [activeTab, setActiveTab] = useState("home");
          const [searchQuery, setSearchQuery] = useState("");
          const [currentTime, setCurrentTime] = useState(new Date());
          const [linkSearchQuery, setLinkSearchQuery] = useState("");
          const [searchResults, setSearchResults] = useState(null);
          const [isSearching, setIsSearching] = useState(false);
          const [latestAnnouncements, setLatestAnnouncements] = useState([]);
          const [showAllDeadlines, setShowAllDeadlines] = useState(false);
          const [headerColor, setHeaderColor] = useState("");
          const [constructionTarget, setConstructionTarget] = useState("");
          const [activeCategory, setActiveCategory] = useState("all");
          const [showLocations, setShowLocations] = useState(false);
          const [activeKaizenYear, setActiveKaizenYear] = useState("");
          const [expandedSections, setExpandedSections] = useState({});
          const [expandedManagers, setExpandedManagers] = useState({});
          const [activeTeamSection, setActiveTeamSection] = useState("HC10");
          const [expandedTeams, setExpandedTeams] = useState({});

          // 時間に応じて色を設定
          useEffect(() => {
            const updateHeaderColor = () => {
              const hour = new Date().getHours();
              const colors = [
                "bg-blue-500", "bg-blue-600", "bg-blue-700", "bg-blue-800",
                "bg-teal-500", "bg-teal-600", "bg-teal-700", "bg-teal-800",
                "bg-cyan-500", "bg-cyan-600", "bg-cyan-700", "bg-cyan-800",
                "bg-indigo-500", "bg-indigo-600", "bg-indigo-700", "bg-indigo-800",
                "bg-purple-500", "bg-purple-600", "bg-purple-700", "bg-purple-800",
                "bg-sky-500", "bg-sky-600", "bg-sky-700", "bg-sky-800"
              ];
              
              const colorIndex = hour % colors.length;
              setHeaderColor(colors[colorIndex]);
            };

            updateHeaderColor();
            
            const intervalId = setInterval(() => {
              const currentHour = new Date().getHours();
              const prevHour = currentTime.getHours();
              
              if (currentHour !== prevHour) {
                updateHeaderColor();
              }
            }, 60000);
            
            return () => clearInterval(intervalId);
          }, [currentTime]);

          // update current time every second
          useEffect(() => {
            const timer = setInterval(() => {
              setCurrentTime(new Date());
            }, 1000);
            return () => clearInterval(timer);
          }, []);

          // 1分ごとにお知らせを自動更新する
          useEffect(() => {
            fetchLatestAnnouncements();
            
            const intervalId = setInterval(() => {
              fetchLatestAnnouncements();
            }, 60000);
            
            return () => clearInterval(intervalId);
          }, []);

          // 組織図データ
          const organizationData = {
            director: {
              name: "鯨井 利毅",
              title: "部長",
              sections: [
                {
                  id: "HC10",
                  name: "HC10",
                  smg: "星崎",
                  description: "システム設計・開発部門。システムアーキテクチャの設計からUI/UX、モバイル開発まで幅広く担当。",
                  directMembers: [],
                  managers: [
                    {
                      id: "HC10-MG1",
                      name: "倉澤",
                      role: "技術マネージャー",
                      description: "バックエンドとインフラを中心とした技術チームを統括。安定したシステム基盤の構築とセキュリティ対策を推進。",
                      teams: [
                        { id: "HC10-MG1-T1", name: "システム設計チーム", leader: "高橋(仁)", members: 5, description: "全社システムの設計・構成管理を担当。要件定義からシステム設計まで一貫して対応。" },
                        { id: "HC10-MG1-T2", name: "インフラ構築チーム", leader: "板橋", members: 6, description: "クラウドインフラとオンプレミスの構築・運用を担当。災害対策・冗長化設計も実施。" },
                        { id: "HC10-MG1-T3", name: "セキュリティチーム", leader: "髙井", members: 4, description: "情報セキュリティ対策の実装と監査を担当。脆弱性診断と対策実施の主導。" }
                      ]
                    },
                    {
                      id: "HC10-MG2",
                      name: "古田",
                      role: "フロントエンド開発マネージャー",
                      description: "UI/UXとフロントエンド開発チームを統括。ユーザー体験を最重視したインターフェース開発を推進。",
                      teams: [
                        { id: "HC10-MG2-T1", name: "UI/UX設計チーム", leader: "澤田", members: 4, description: "ユーザーインターフェースとユーザーエクスペリエンスの設計を担当。ユーザーテストの実施と分析。" },
                        { id: "HC10-MG2-T2", name: "フロントエンド開発チーム", leader: "堀川", members: 6, description: "最新のフロントエンド技術を活用したウェブアプリケーション開発を担当。" },
                        { id: "HC10-MG2-T3", name: "モバイル開発チーム", leader: "國友", members: 5, description: "iOS/Android向けのネイティブ・ハイブリッドアプリ開発を担当。" }
                      ]
                    }
                  ]
                },
                {
                  id: "HC60",
                  name: "HC60",
                  smg: "",
                  description: "データ基盤とバックエンド開発部門。データベース設計、API開発、自動化基盤の構築を担当。",
                  directMembers: [],
                  managers: [
                    {
                      id: "HC60-MG1",
                      name: "四方 裕之",
                      role: "バックエンド開発マネージャー",
                      description: "バックエンドシステムとデータ基盤の開発・運用チームを統括。データの安全性と可用性の確保を重視。",
                      teams: [
                        { id: "HC60-MG1-T1", name: "データベースチーム", leader: "渡辺 拓也", members: 4, description: "データベース設計・最適化・運用を担当。大規模データの効率的な処理基盤を構築。" },
                        { id: "HC60-MG1-T2", name: "バックエンド開発チーム", leader: "藤田 健太", members: 7, description: "コアシステムのバックエンド開発を担当。ビジネスロジックの実装と最適化。" },
                        { id: "HC60-MG1-T3", name: "API開発チーム", leader: "加藤 裕子", members: 5, description: "内部・外部向けAPIの設計と開発を担当。マイクロサービスアーキテクチャの推進。" }
                      ]
                    }
                  ]
                },
                {
                  id: "HC70",
                  name: "HC70",
                  smg: "金子 弘嗣",
                  description: "プロジェクト管理・品質保証・運用部門。プロジェクト全体の進行管理と品質向上、運用効率化を担当。",
                  directMembers: [
                    { id: "HC70-DM1", name: "井戸 志具馬", role: "テクニカルスペシャリスト", description: "高度な技術課題の解決とアーキテクチャ設計のサポートを担当。各チームへの技術支援を提供。" }
                  ],
                  managers: [
                    {
                      id: "HC70-MG1",
                      name: "石上 博丈",
                      role: "管理マネージャー",
                      description: "プロジェクト全体の管理と品質保証を統括。スケジュール・コスト・品質の最適なバランスを追求。",
                      teams: [
                        { id: "HC70-MG1-T1", name: "企画チーム", leader: "山口 康信", members: 2, description: "プロジェクト計画立案・進捗管理・リスク管理を担当。プロジェクトの成功に向けた調整。" },
                        { id: "HC70-MG1-T2", name: "ＰＭＯチーム", leader: "坂井 信介", members: 2, description: "品質基準の策定とテスト計画・実行を担当。品質向上のためのプロセス改善を推進。" }
                      ]
                    }
                  ]
                }
              ]
            }
          };

          // 各課のPDFリンク
          const sectionPdfLinks = {
            "HC10": "https://drive.google.com/file/d/1C_2a2B4le1Z-gmYxKRncCe4In6vBsKyd/view",
            "HC60": "https://drive.google.com/file/d/18kjEhWoa0aQD1G2kGvvZoxi4tLzlba1T/view",
            "HC70": "https://drive.google.com/file/d/194tY_gPIeW-GIK-8DMi4uuusaU6Gg4QU/view",
            "HD10": "https://drive.google.com/file/d/1ps8E9tpXB_jfPsepurDv3JJ-bsEn3p00/view",
            "HD70": "https://drive.google.com/file/d/1YRtZ6BvclHZhG3ahVyHy_N3TnzjMD-8s/view",
          };

          const announcements = [
            {
              id: 1,
              title: "四半期会議のお知らせ",
              date: "2025-11-15",
              content: "次回の四半期会議は11月20日14:00から会議室Aで開催されます。全員参加をお願いします。",
              author: "田中部長",
            },
            {
              id: 2,
              title: "新システム導入について",
              date: "2025-11-10",
              content: "来月から新しい文書管理システムを導入します。詳細は添付ファイルをご確認ください。",
              author: "IT部 佐藤",
            },
            {
              id: 3,
              title: "年末調整の提出期限",
              date: "2025-11-05",
              content: "年末調整書類の提出期限は12月10日です。期限厳守でお願いします。",
              author: "総務部 鈴木",
            },
          ];

          const fetchLatestAnnouncements = () => {
            const currentHour = new Date().getHours();
            const currentMinute = String(new Date().getMinutes()).padStart(2, "0");
            const timestamp = new Date().toISOString();
            
            const dynamicAnnouncements = [
              {
                id: 100 + currentHour,
                title: `${currentHour}時のシステムメンテナンス情報`,
                date: timestamp,
                content: `現在、いくつかのシステムでメンテナンスを実施中です。アクセスできない場合はしばらくお待ちください。(${currentHour}:${currentMinute}更新)`,
                author: "システム管理部",
              },
              {
                id: 200 + currentHour,
                title: `${currentHour}時現在の障害情報`,
                date: timestamp,
                content: `現在、報告されている障害はありません。(${currentHour}:${currentMinute}更新)`,
                author: "IT運用チーム",
              }
            ];
            
            const allAnnouncements = [...announcements, ...dynamicAnnouncements]
              .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            setLatestAnnouncements(allAnnouncements);
          };

          const deadlines = [
            {
              id: 1,
              title: "年末調整書類提出",
              date: "2026-12-10",
              category: "書類",
              priority: "high",
              department: "総務部",
              description: "年末調整書類の提出期限です。必要書類を全て揃えて提出してください。",
              icon: <IconReceiptText size={18} />,
            },
            {
              id: 2,
              title: "第3四半期予算申請",
              date: "2026-11-30",
              category: "予算",
              priority: "high",
              department: "経理部",
              description: "第3四半期の予算申請締め切りです。所定フォーマットに入力してください。",
              icon: <IconFileDollar size={18} />,
            },
            {
              id: 3,
              title: "業務報告書提出",
              date: "2026-11-25",
              category: "書類",
              priority: "medium",
              department: "人事部",
              description: "10月分の業務報告書を提出してください。",
              icon: <IconClipboard size={18} />,
            },
            {
              id: 4,
              title: "健康診断予約",
              date: "2026-02-05",
              category: "健康",
              priority: "medium",
              department: "総務部",
              description: "年次健康診断の予約締め切りです。指定されたリンクから予約してください。",
              icon: <IconActivity size={18} />,
            },
          ];

          const upcomingDeadlines = deadlines
            .filter((d) => {
              const remaining = getDaysRemaining(d.date);
              return remaining >= 0 && remaining <= 30;
            })
            .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());

          const systemLinks = [
            {
              id: 1,
              title: "E-learn",
              url: "https://clipline.jp/training/#/",
              icon: <IconGraduationCap size={24} />,
              description: "オンライン学習プラットフォーム",
              category: "tools",
              color: "bg-teal-600",
            },
            {
              id: 2,
              title: "会議室予約アプリ",
              onClick: () => {
                setConstructionTarget("会議室予約アプリ");
                setActiveTab("construction");
              },
              icon: <IconCalendar size={24} />,
              description: "会議室の予約・確認を行うシステム",
              category: "facility",
              color: "bg-red-600",
            },
            {
              id: 3,
              title: "社内FAQ",
              onClick: () => {
                setConstructionTarget("社内FAQ");
                setActiveTab("construction");
              },
              icon: <IconHelpCircle size={24} />,
              description: "よくある質問や社内ルール集",
              category: "info",
              color: "bg-purple-600",
            },
          ];

          const coreLinks = [
            {
              id: 1,
              title: "社活サイト",
              description: "日報入力はこちら",
              url: "http://aemlinux3.nekonet.co.jp/aem/aem.php",
              icon: <IconActivity size={28} />,
              color: "bg-teal-600"
            },
            {
              id: 2,
              title: "TW申請",
              description: "テレワーク申請システム",
              url: "http://dominoap.nekonet.co.jp/tyo/tyo0993.nsf/MainFrame?OpenFrameSet",
              icon: <IconClipboard size={28} />,
              color: "bg-teal-600",
              fullDescription: "テレワーク（在宅勤務）を行う際の申請システム",
              frequency: "テレワーク予定日の3営業日前までに申請が必要です",
            },
          ];

          const locations = [
            { id: "harumi", name: "晴海" },
            { id: "toyouchou", name: "東陽町" },
            { id: "osaka", name: "大阪" },
          ];

          const osakaActivity = {
            title: "大阪オフィス レイアウト最適化プロジェクト",
            summary: "大阪オフィスのフロアレイアウトを見直し、チーム間のコミュニケーション動線を改善。座席入れ替えと共有スペースの拡充を実施しました。",
            impact: "部署間連携の迅速化により、月次レポート作成時間が10%短縮。社員満足度調査でもオフィス環境に関する評価が20%向上。",
            image: "https://images.unsplash.com/photo-1526401485004-2fda9ca1286e?auto=format&fit=crop&w=1470&q=80",
          };

          const linkCategories = [
            { id: "all", name: "すべて", icon: <IconGridIcon size={20} /> },
            { id: "portal", name: "ポータルサイト", icon: <IconLink size={20} /> },
            { id: "system", name: "システム", icon: <IconServer size={20} /> },
            { id: "document", name: "ドキュメント", icon: <IconFileText size={20} /> },
            { id: "tools", name: "ツール", icon: <IconTool size={20} /> },
            { id: "facility", name: "施設・設備", icon: <IconMapPin size={20} /> },
          ];

          const kaizenActivities = {
            "2025": [
              {
                id: 1,
                team: "チームA",
                members: ["鈴木 健太", "佐藤 美咲", "田中 大輔"],
                title: "会議室予約システムのUI改善",
                description: "会議室予約システムの操作性を向上させるためのUI/UX改善プロジェクト。検索機能の追加とカレンダー表示の最適化を実施。",
                results: "予約プロセスが平均2分短縮され、ユーザー満足度が25%向上しました。",
                technologies: ["React", "Material UI", "Node.js"],
                image: "https://images.unsplash.com/photo-1587825140708-dfaf72ae4b04?q=80&w=1470&auto=format&fit=crop"
              },
              {
                id: 2,
                team: "チームB",
                members: ["山本 隆", "高橋 直子", "小林 拓也"],
                title: "テスト環境自動構築ツール",
                description: "テスト環境の構築を自動化するスクリプトとツールの開発。環境構築時間を短縮し、一貫性のある検証環境を提供。",
                results: "環境構築時間が80%削減され、週に約12時間の作業時間削減を実現しました。",
                technologies: ["Docker", "Jenkins", "Python", "Ansible"],
                image: "https://images.unsplash.com/photo-1633412802994-5c058f151b66?q=80&w=1470&auto=format&fit=crop"
              }
            ],
            "2024": [
              {
                id: 4,
                team: "チームD",
                members: ["石田 雄大", "加藤 優子", "斎藤 健太"],
                title: "社内勤怠管理システムのモバイル対応",
                description: "既存の勤怠管理システムをモバイル対応させ、外出先からも打刻可能なシステムへと拡張。",
                results: "リモートワーク時の打刻忘れが90%減少し、管理工数が月間約5時間削減されました。",
                technologies: ["React Native", "Firebase", "Node.js"],
                image: "https://images.unsplash.com/photo-1607706009771-de8808640bcf?q=80&w=1470&auto=format&fit=crop"
              }
            ]
          };

          const newEmployeeGuides = [
            {
              id: 101,
              title: "はじめての勤怠管理",
              url: "#",
              category: "newemployee",
              description: "入社したらまず覚えたい勤怠管理システムの使い方ガイド",
              color: "bg-blue-100",
              icon: <IconClock size={24} />,
              steps: [
                "1. 出社時に「出勤」ボタンを押す",
                "2. 退社時に「退勤」ボタンを押す",
                "3. 残業が発生した場合は理由を入力",
                "4. 休暇申請は1週間前までに行う"
              ]
            },
            {
              id: 102,
              title: "テレワーク申請の流れ",
              url: "#",
              category: "newemployee",
              description: "テレワーク申請システム（TW申請）の利用方法と注意点",
              color: "bg-green-100",
              icon: <IconClipboard size={24} />,
              steps: [
                "1. テレワーク希望日の3営業日前までに申請",
                "2. 上長の承認を得る",
                "3. テレワーク当日も勤怠システムで出退勤の打刻が必要",
                "4. 業務報告は当日中に提出"
              ]
            },
            {
              id: 103,
              title: "社内システムアクセスガイド",
              url: "#",
              category: "newemployee",
              description: "各種社内システムのアクセス方法と必要な権限について",
              color: "bg-purple-100",
              icon: <IconServer size={24} />,
              steps: [
                "1. 社内ネットワークに接続（VPN経由も可）",
                "2. 自分のユーザーIDとパスワードでログイン",
                "3. 初回アクセス時は各システム管理者に権限申請が必要",
                "4. パスワードは定期的に変更（90日ごと）"
              ]
            },
            {
              id: 104,
              title: "社内コミュニケーション",
              url: "#",
              category: "newemployee",
              description: "社内のコミュニケーションツールと使い分けガイド",
              color: "bg-amber-100", 
              icon: <IconMessageSquare size={24} />,
              steps: [
                "1. チャットは簡単な連絡や相談に",
                "2. メールは正式な依頼や複数人への連絡に",
                "3. 重要な決定事項は必ず文書化",
                "4. 緊急時は電話連絡（内線表参照）"
              ]
            }
          ];

          const linkCollection = [
            { id: 1, title: "カニシステム（勤怠情報）", url: "http://vo-ov.nekonet.co.jp/YadokariWeb/SRC01Action_doInit.action", category: "system", description: "出退勤の記録を行う勤怠システム", color: "bg-teal-100" },
            { id: 2, title: "感染症罹患報告（Redmine）", url: "http://syshon-redmine.nekonet.co.jp/login?back_url=http%3A%2F%2Fsyshon-redmine.nekonet.co.jp%2Fprojects%2Frikan%2Fissues%3Fquery_id%3D355", category: "system", description: "感染症罹患時の報告用Redmineプロジェクト", color: "bg-purple-100" },
            { id: 3, title: "Oneデジタルポータルサイト", url: "https://sites.google.com/kuronekoyamato.co.jp/digital-portal/%E3%83%9B%E3%83%BC%E3%83%A0", category: "portal", description: "社内の主要サービスにアクセスするための統合ポータル", color: "bg-blue-100" },
            { id: 4, title: "ヤマト関連ポータル", url: "http://gs.nekonet.co.jp/", category: "portal", description: "ヤマトグループ関連の情報サイト", color: "bg-blue-100" },
            { id: 5, title: "NEKO基準ドキュメント", url: "http://gs.nekonet.co.jp/GS_System/systemkaihatu_unyoumanual_kanren.html", category: "document", description: "開発標準、設計ガイドライン、コーディング規約など", color: "bg-green-100" },
            { id: 6, title: "リリース管理統合システム", url: "http://gs.nekonet.co.jp/gs_release/quality/", category: "system", description: "システムリリースのスケジュール管理と承認フロー", color: "bg-purple-100" },
            { id: 7, title: "構成管理活動", url: "http://gs.nekonet.co.jp/GS_Config/kouseikanri.html", category: "document", description: "構成管理プロセスとベストプラクティス", color: "bg-green-100" },
            { id: 8, title: "E-learn", url: "https://clipline.jp/training/#/", category: "tools", description: "オンライン学習プラットフォーム", color: "bg-yellow-100" }
          ];

          useEffect(() => {
            const years = Object.keys(kaizenActivities).map(y => Number(y));
            if (years.length) {
              const latest = Math.max(...years);
              setActiveKaizenYear(String(latest));
            }
          }, []);

          const toggleTeam = (teamId) => {
            setExpandedTeams(prev => ({
              ...prev,
              [teamId]: !prev[teamId]
            }));
          };

          const getTeamsBySectionId = (sectionId) => {
            const section = organizationData.director.sections.find(s => s.id === sectionId);
            if (!section) return [];
            
            const teams = [];
            section.managers.forEach(manager => {
              manager.teams.forEach(team => {
                teams.push({
                  ...team,
                  manager: manager
                });
              });
            });
            
            return teams;
          };

          const getFilteredLinks = () => {
            let filteredLinks = [];
            if (activeCategory === 'all') {
              const regularLinks = linkCollection.filter(link => 
                link.title.toLowerCase().includes(linkSearchQuery.toLowerCase())
              );
              
              filteredLinks = regularLinks;
            } else {
              filteredLinks = linkCollection.filter(link => 
                link.category === activeCategory && 
                link.title.toLowerCase().includes(linkSearchQuery.toLowerCase())
              );
            }
            
            return filteredLinks;
          };

          function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
          }

          function getDaysRemaining(dateString) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const targetDate = new Date(dateString);
            targetDate.setHours(0, 0, 0, 0);

            const diffTime = targetDate.getTime() - today.getTime();
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            return diffDays;
          }

          const searchContent = (query) => {
            if (!query || query.trim() === '') {
              setSearchResults(null);
              return;
            }

            setIsSearching(true);
            const searchLower = query.toLowerCase();
            
            const foundAnnouncements = latestAnnouncements.filter(item => 
              item.title.toLowerCase().includes(searchLower) || 
              item.content.toLowerCase().includes(searchLower) ||
              item.author.toLowerCase().includes(searchLower)
            );
            
            const foundLinks = linkCollection.filter(item => 
              item.title.toLowerCase().includes(searchLower) || 
              item.description.toLowerCase().includes(searchLower)
            );
            
            const foundDeadlines = deadlines.filter(item => 
              item.title.toLowerCase().includes(searchLower) || 
              item.description.toLowerCase().includes(searchLower) ||
              item.department.toLowerCase().includes(searchLower) ||
              item.category.toLowerCase().includes(searchLower)
            );
            
            const foundGuides = newEmployeeGuides.filter(item => 
              item.title.toLowerCase().includes(searchLower) || 
              item.description.toLowerCase().includes(searchLower) ||
              item.steps.some(step => step.toLowerCase().includes(searchLower))
            );

            const foundKaizenActivities = [];
            Object.keys(kaizenActivities).forEach(year => {
              kaizenActivities[year].forEach(activity => {
                if (
                  activity.title.toLowerCase().includes(searchLower) ||
                  activity.description.toLowerCase().includes(searchLower) ||
                  activity.results.toLowerCase().includes(searchLower) ||
                  activity.team.toLowerCase().includes(searchLower) ||
                  activity.members.some(member => member.toLowerCase().includes(searchLower)) ||
                  activity.technologies.some(tech => tech.toLowerCase().includes(searchLower))
                ) {
                  foundKaizenActivities.push({
                    ...activity,
                    year: year
                  });
                }
              });
            });
            
            const results = {
              announcements: foundAnnouncements,
              links: foundLinks,
              deadlines: foundDeadlines,
              guides: foundGuides,
              kaizenActivities: foundKaizenActivities
            };
            
            setSearchResults(results);
            setIsSearching(false);
            setActiveTab("search-results");
            
            return results;
          };

          const handleSearch = (e) => {
            e.preventDefault();
            searchContent(searchQuery);
          };

          const handleSearchChange = (e) => {
            setSearchQuery(e.target.value);
          };

          const handleSearchKeyDown = (e) => {
            if (e.key === 'Enter') {
              e.preventDefault();
              searchContent(searchQuery);
            }
          };

          const handleColumnClick = () => {
            setConstructionTarget("今週のコラム");
            setActiveTab("construction");
          };

          const menuItems = [
            { id: "home", label: "ホーム", icon: <IconHome size={20} /> },
            { id: "announcements", label: "お知らせ", icon: <IconInfo size={20} /> },
            { id: "documents", label: "文書", icon: <IconFileText size={20} /> },
            { id: "links", label: "リンク集", icon: <IconLink size={20} /> },
            { id: "organization", label: "チーム紹介", icon: <IconOrganization size={20} /> },
            { id: "guide", label: "新人ガイド", icon: <IconGraduationCap size={20} /> },
            { id: "misc", label: "その他", icon: <IconMoreHorizontal size={20} /> },
          ];

          return (
            <div className="flex flex-col h-full bg-gray-50" style={{fontFamily: "'Noto Sans JP', sans-serif", fontSize: "calc(1rem + 3px)"}}>
              {/* Header */}
              <header
                className="relative text-white shadow-md"
                style={{
                  backgroundImage: "url(https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1950&q=80)",
                  backgroundSize: "cover",
                  backgroundPosition: "center",
                  height: "150px",
                }}
              >
                <div className="relative container mx-auto px-6 py-10 h-full flex items-center">
                  <div className="flex justify-between items-center w-full">
                    <div className="flex items-center space-x-5">
                      <div className="flex flex-col">
                        <div className="font-bold text-3xl drop-shadow mb-2">
                          グループシステム部 イントラサイト
                        </div>
                      </div>
                    </div>
                    <form onSubmit={handleSearch} className="relative">
                      <input
                        type="text"
                        placeholder="検索キーワードを入力"
                        className="py-3 px-6 pr-12 rounded-full text-base bg-white text-gray-800 focus:outline-none focus:ring-4 focus:ring-teal-300 shadow-lg border border-teal-300 w-80"
                        value={searchQuery}
                        onChange={handleSearchChange}
                        onKeyDown={handleSearchKeyDown}
                      />
                      <button 
                        type="submit"
                        className="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-teal-600 focus:outline-none"
                      >
                        <IconSearch size={22} />
                      </button>
                    </form>
                  </div>
                </div>
              </header>

              {/* Main Navigation */}
              <nav className="bg-teal-700 text-white shadow-md">
                <div className="w-full mx-auto">
                  <div className="flex divide-x divide-gray-600/50">
                    {menuItems.map((item) => (
                      <button
                        key={item.id}
                        className={`flex-1 flex flex-col items-center justify-center py-4 transition-colors ${
                          activeTab === item.id
                            ? "bg-teal-800 border-b-3 border-white"
                            : "hover:bg-teal-600"
                        }`}
                        onClick={() => setActiveTab(item.id)}
                      >
                        {item.icon}
                        <span className="text-sm mt-2 font-medium text-[24px]">
                          {item.label}
                        </span>
                      </button>
                    ))}

                    <div
                      className="relative flex-1"
                      onMouseEnter={() => setShowLocations(true)}
                      onMouseLeave={() => setShowLocations(false)}
                    >
                      <button
                        className={`flex flex-col items-center justify-center w-full h-full py-4 transition-colors ${
                          activeTab === "construction" && locations.some((l) => l.name === constructionTarget)
                            ? "bg-teal-800 border-b-3 border-white"
                            : showLocations
                            ? "bg-teal-600"
                            : "hover:bg-teal-600"
                        }`}
                      >
                        <IconMapPin size={20} />
                        <span className="text-sm mt-2 font-medium text-[24px]">拠点別情報</span>
                      </button>
                      {showLocations && (
                        <div className="absolute left-0 top-full mt-1 z-20">
                          <div className="bg-white text-gray-700 shadow-lg rounded w-40 divide-y divide-gray-200">
                            {locations.map((loc) => (
                              <button
                                key={loc.id}
                                className="w-full text-left px-4 py-3 hover:bg-gray-100 text-base"
                                onClick={() => {
                                  setConstructionTarget(loc.name);
                                  setActiveTab("construction");
                                  setShowLocations(false);
                                }}
                              >
                                {loc.name}
                              </button>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              </nav>

              {/* Main Content */}
              <div className="flex-grow flex flex-col md:flex-row">
                {/* Sidebar */}
                <aside className="w-72 flex-shrink-0 bg-white shadow-md p-6 pt-10 md:min-h-0">
                  <div className="mb-8">
                    <h3 className="font-medium text-lg text-gray-700 mb-3 flex items-center">
                      <IconClock size={20} className="mr-2 text-teal-500" />
                      現在時刻
                    </h3>
                    <div className={`text-2xl font-bold text-white p-2 rounded shadow ${headerColor} bg-opacity-50`}>
                      {currentTime.toLocaleTimeString("ja-JP")}
                    </div>
                    <div className="text-base text-gray-700 mt-1">
                      {currentTime.toLocaleDateString("ja-JP", {
                        year: "numeric",
                        month: "long",
                        day: "numeric",
                        weekday: "long",
                      })}
                    </div>
                  </div>

                  <div className="mb-8">
                    <h3 className="font-medium text-lg text-gray-700 mb-3 flex items-center">
                      <IconAlertTriangle size={20} className="mr-2 text-amber-500" />
                      直近の締め切り
                    </h3>
                    <div className="space-y-3">
                      {upcomingDeadlines.slice(0, 2).map((deadline) => {
                        const daysRemaining = getDaysRemaining(deadline.date);
                        let statusColor = "text-gray-700";
                        if (daysRemaining <= 3) statusColor = "text-red-600";
                        else if (daysRemaining <= 7) statusColor = "text-amber-600";

                        return (
                          <div
                            key={deadline.id}
                            className="text-base border-l-3 border-amber-500 pl-3 py-2 bg-amber-50 rounded-r-md"
                          >
                            <div className="font-medium text-gray-900">
                              {deadline.title}
                            </div>
                            <div className="mt-1 text-base">
                              <span className="font-medium text-gray-800">
                                {formatDate(deadline.date)}
                              </span>
                              <span className={`ml-2 ${statusColor} font-medium`}>
                                あと{daysRemaining}日
                              </span>
                            </div>
                          </div>
                        );
                      })}
                      {upcomingDeadlines.length === 0 && (
                        <p className="text-base text-gray-500">直近1か月以内の締め切りはありません</p>
                      )}
                    </div>
                  </div>

                  <div className="mb-8">
                    <h3 className="font-medium text-lg text-gray-700 mb-3 flex items-center">
                      <IconChairs size={20} className="mr-2 text-blue-600" />
                      全社座席表
                    </h3>
                    <a
                      href="http://shachoushitsu.nekonet.co.jp/k_kikaku/zaseki/zaseki_gws.html"
                      target="_blank"
                      rel="noreferrer"
                      className="block px-3 py-2 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors text-blue-700 font-medium flex items-center"
                    >
                      <IconExternalLink size={16} className="mr-2" />
                      座席表を開く
                    </a>
                  </div>

                  <div className="mb-8">
                    <h3 className="font-medium text-lg text-gray-700 mb-3 flex items-center">
                      <IconPdf size={20} className="mr-2 text-red-600" />
                      体制図(PDF)
                    </h3>
                    <div className="space-y-2 text-base">
                      {Object.entries(sectionPdfLinks).map(([sec, url]) => (
                        <a
                          key={sec}
                          href={url}
                          target="_blank"
                          rel="noreferrer"
                          className="block px-3 py-2 rounded-md border border-gray-200 hover:bg-gray-50 transition-colors text-teal-700 font-medium"
                        >
                          {sec}
                        </a>
                      ))}
                    </div>
                  </div>

                  <div className="mb-8">
                    <button 
                      onClick={handleColumnClick}
                      className="w-full bg-green-100 hover:bg-green-200 text-gray-800 rounded-lg shadow-md overflow-hidden transition-all hover:shadow-lg transform hover:-translate-y-1"
                    >
                      <div className="p-4 flex items-center">
                        <div className="bg-white rounded-full p-2 mr-3">
                          <IconNewspaper size={24} className="text-teal-600" />
                        </div>
                        <div className="text-left">
                          <h3 className="font-bold text-lg">今週のコラム</h3>
                          <p className="text-sm opacity-90">最新の技術トレンドや部内活動を紹介</p>
                        </div>
                      </div>
                    </button>
                  </div>
                </aside>

                {/* Main Content Area */}
                <main className="flex-grow p-6 overflow-auto">
                  {activeTab === "home" && (
                    <div className="space-y-8">
                      <div className="w-full max-w-7xl mx-auto p-4">
                        <div className="bg-white rounded-lg shadow-md p-6">
                          <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <IconAlertTriangle size={24} className="mr-3 text-amber-500" />
                            重要な締め切り
                          </h2>
                          <div className="overflow-hidden">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
                              {(showAllDeadlines ? deadlines : deadlines.slice(0,2)).map((deadline) => {
                                const daysRemaining = getDaysRemaining(deadline.date);
                                const timelineColor = "bg-red-400";
                                
                                return (
                                  <div
                                    key={deadline.id}
                                    className="bg-white border rounded-lg overflow-hidden shadow-sm flex"
                                  >
                                    <div className={`w-2 ${timelineColor}`}></div>
                                    
                                    <div className="p-4 flex-1">
                                      <div className="flex items-start justify-between mb-3">
                                        <div className="flex items-center">
                                          <div className="mr-3 text-teal-600">
                                            {deadline.icon}
                                          </div>
                                          <h3 className="font-semibold text-lg text-gray-900">
                                            {deadline.title}
                                          </h3>
                                        </div>
                                      </div>
                                      
                                      <div className="text-base text-gray-800 mb-3">
                                        {deadline.description}
                                      </div>
                                      
                                      <div className="flex justify-between text-base">
                                        <div>
                                          <span className="text-gray-600">提出先: </span>
                                          <span className="font-medium">{deadline.department}</span>
                                        </div>
                                        <div className="font-medium flex items-center">
                                          <IconCalendar size={16} className="mr-2 text-teal-600" />
                                          {formatDate(deadline.date)}
                                          <span className={`ml-2 ${daysRemaining <= 3 ? "text-red-600" : "text-gray-600"} font-bold`}>
                                            (あと{daysRemaining}日)
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                );
                              })}
                            </div>
                            <div className="mt-4 flex justify-end">
                              <button
                                onClick={() => setShowAllDeadlines(!showAllDeadlines)}
                                className="text-sm text-teal-600 hover:text-teal-800 font-medium flex items-center"
                              >
                                {showAllDeadlines ? "折りたたむ" : "もっと見る"}
                                <IconChevronDown
                                  size={16}
                                  className={`ml-1 transition-transform ${showAllDeadlines ? "rotate-180" : "rotate-0"}`}
                                />
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div className="w-full max-w-7xl mx-auto p-4">
                        <div className="flex flex-col md:flex-row gap-4 md:h-[380px]">
                          
                          <div className="md:w-[40%] h-64 md:h-full">
                            <div 
                              onClick={() => coreLinks[0]?.url && window.open(coreLinks[0].url, '_blank')}
                              className="h-full rounded-2xl shadow-lg overflow-hidden cursor-pointer group relative"
                            >
                              <div className="h-full bg-gradient-to-br from-green-600 to-green-800 p-8 text-white flex flex-col justify-center items-center">
                                <div className="bg-white/20 backdrop-blur-md p-5 rounded-3xl mb-6 transform group-hover:scale-110 transition-transform duration-500">
                                  <IconActivity size={60} />
                                </div>
                                <h3 className="font-bold text-3xl mb-3 text-white">社活サイト</h3>
                                <p className="text-white/90 text-center text-lg max-w-xs">{coreLinks[0]?.description || "社内活動情報ポータル"}</p>
                                
                                <div className="absolute bottom-6 right-6 p-3 bg-white/20 backdrop-blur-sm rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                  <IconExternalLink size={24} />
                                </div>
                              </div>
                            </div>
                          </div>

                          <div className="md:w-[30%] flex flex-col gap-4">
                            <div 
                              onClick={() => {
                                if (setConstructionTarget) setConstructionTarget("会議室予約アプリ");
                                if (setActiveTab) setActiveTab("construction");
                              }}
                              className="flex-1 rounded-2xl shadow-md overflow-hidden cursor-pointer group relative"
                            >
                              <div className="h-full bg-gradient-to-br from-purple-500 to-purple-700 p-6 text-white flex flex-col justify-center items-center">
                                <div className="bg-white/20 backdrop-blur-sm p-3 rounded-full mb-3">
                                  <IconCalendar size={32} />
                                </div>
                                <h3 className="font-bold text-xl mb-1 text-center">{systemLinks[1]?.title || "会議室予約"}</h3>
                                <p className="text-white/80 text-sm text-center">{systemLinks[1]?.description || "施設の予約管理"}</p>
                                <div className="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                  <IconExternalLink />
                                </div>
                              </div>
                            </div>
                            
                            <div 
                              onClick={() => window.open("#", '_blank')}
                              className="flex-1 rounded-2xl shadow-md overflow-hidden cursor-pointer group relative"
                            >
                              <div className="h-full bg-gradient-to-br from-purple-600 to-purple-800 p-6 text-white flex flex-col justify-center items-center">
                                <div className="bg-white/20 backdrop-blur-sm p-3 rounded-full mb-3">
                                  <IconHelpCircle size={32} />
                                </div>
                                <h3 className="font-bold text-xl mb-1 text-center">社内FAQ</h3>
                                <p className="text-white/80 text-sm text-center">よくある質問と回答</p>
                                <div className="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                  <IconExternalLink />
                                </div>
                              </div>
                            </div>
                          </div>

                          <div className="md:w-[30%] flex flex-col gap-4">
                            <div 
                              onClick={() => window.open("http://gs.nekonet.co.jp/GS_wiki/", '_blank')}
                              className="flex-1 rounded-2xl shadow-md overflow-hidden cursor-pointer group relative"
                            >
                              <div className="h-full bg-gradient-to-br from-blue-500 to-blue-600 p-4 text-white flex flex-col justify-center items-center">
                                <IconFileText size={28} className="mb-2" />
                                <h3 className="font-bold text-lg text-center">GSうぃき</h3>
                                <p className="text-white/70 text-xs text-center">部内Wikiポータル</p>
                                <div className="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                  <IconExternalLink size={16} />
                                </div>
                              </div>
                            </div>

                            <div 
                              onClick={() => coreLinks[1]?.url && window.open(coreLinks[1].url, '_blank')}
                              className="flex-1 rounded-2xl shadow-md overflow-hidden cursor-pointer group relative"
                            >
                              <div className="h-full bg-gradient-to-br from-blue-600 to-blue-700 p-4 text-white flex flex-col justify-center items-center">
                                <IconClipboard size={28} className="mb-2" />
                                <h3 className="font-bold text-lg text-center">{coreLinks[1]?.title || "TW申請"}</h3>
                                <p className="text-white/70 text-xs text-center">{coreLinks[1]?.description || "テレワーク利用申請"}</p>
                                <div className="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                  <IconExternalLink size={16} />
                                </div>
                              </div>
                            </div>

                            <div 
                              onClick={() => window.open("https://clipline.jp/training/#/", '_blank')}
                              className="flex-1 rounded-2xl shadow-md overflow-hidden cursor-pointer group relative"
                            >
                              <div className="h-full bg-gradient-to-br from-blue-700 to-blue-800 p-4 text-white flex flex-col justify-center items-center">
                                <IconGraduationCap size={28} className="mb-2" />
                                <h3 className="font-bold text-lg text-center">{systemLinks[0]?.title || "E-learning"}</h3>
                                <p className="text-white/70 text-xs text-center">{systemLinks[0]?.description || "社内研修・教育"}</p>
                                <div className="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                  <IconExternalLink size={16} />
                                </div>
                              </div>
                            </div>
                          </div>

                        </div>
                      </div>

                      <div className="bg-white rounded-lg shadow-md p-6">
                        <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                          <IconInfo size={24} className="mr-3 text-teal-500" />
                          最新のお知らせ
                          <span className="ml-2 text-sm text-gray-500 font-normal">
                            (自動更新中: {new Date().toLocaleTimeString('ja-JP')})
                          </span>
                        </h2>
                        <div className="space-y-5">
                          {latestAnnouncements.slice(0, 3).map((announcement) => (
                            <div
                              key={announcement.id}
                              className="border-b pb-4 last:border-0 last:pb-0"
                            >
                              <div className="flex justify-between items-start">
                                <h3 className="font-semibold text-lg text-teal-700">
                                  {announcement.title}
                                </h3>
                                <span className="text-sm text-gray-500">
                                  {new Date(announcement.date).toLocaleString("ja-JP")}
                                </span>
                              </div>
                              <p className="text-gray-800 mt-2 text-base">
                                {announcement.content}
                              </p>
                              <div className="text-sm text-gray-600 mt-2">
                                投稿者: {announcement.author}
                              </div>
                            </div>
                          ))}
                        </div>
                        <button
                          className="mt-4 text-base text-teal-600 hover:text-teal-800 flex items-center"
                          onClick={() => setActiveTab("announcements")}
                        >
                          すべてのお知らせを見る →
                        </button>
                      </div>
                    </div>
                  )}

                  {activeTab === "organization" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <div className="flex justify-between items-center mb-6">
                        <h2 className="text-2xl font-bold text-gray-800 flex items-center">
                          <IconOrganization size={24} className="mr-3 text-teal-500" />
                          チーム紹介
                        </h2>
                        <a 
                          href={sectionPdfLinks[activeTeamSection]} 
                          target="_blank"
                          rel="noreferrer"
                          className="flex items-center text-teal-600 hover:text-teal-800"
                        >
                          <IconPdf size={20} className="mr-2" />
                          <span className="font-medium">PDF版</span>
                        </a>
                      </div>

                      <div className="mb-8">
                        <div className="bg-teal-600 text-white p-5 rounded-lg shadow-md flex items-center">
                          <div className="bg-white p-3 rounded-full mr-4">
                            <IconDirector size={36} className="text-teal-600" />
                          </div>
                          <div>
                            <h3 className="text-xl font-bold">グループシステム部 部長</h3>
                            <p className="text-lg">{organizationData.director.name}</p>
                          </div>
                        </div>
                      </div>

                      <div className="border-b border-gray-200 mb-6">
                        <div className="flex overflow-x-auto">
                          {organizationData.director.sections.map((section) => (
                            <button
                              key={section.id}
                              onClick={() => setActiveTeamSection(section.id)}
                              className={`py-3 px-6 font-medium text-lg border-b-2 transition-colors ${
                                activeTeamSection === section.id
                                  ? "border-teal-600 text-teal-600"
                                  : "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"
                              }`}
                            >
                              {section.name}
                            </button>
                          ))}
                        </div>
                      </div>

                      {organizationData.director.sections
                        .filter(section => section.id === activeTeamSection)
                        .map(section => (
                        <div key={section.id}>
                          <div className="bg-teal-50 p-5 rounded-lg border border-teal-100 mb-6">
                            <div className="flex items-start">
                              <div className="bg-teal-600 p-3 rounded-full mr-4">
                                <IconSectionManager size={28} className="text-white" />
                              </div>
                              <div className="flex-1">
                                <h3 className="text-xl font-bold text-gray-800 mb-2">{section.name}</h3>
                                <p className="text-gray-700 mb-1 font-medium">SMG: {section.smg}</p>
                                <p className="text-gray-600">{section.description}</p>
                              </div>
                            </div>
                          </div>

                          {section.directMembers && section.directMembers.length > 0 && (
                            <div className="mb-6">
                              <h4 className="text-lg font-medium text-gray-800 mb-3 flex items-center">
                                <IconUser size={20} className="mr-2 text-gray-600" />
                                SMG直轄メンバー
                              </h4>
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {section.directMembers.map(member => (
                                  <div 
                                    key={member.id} 
                                    className="bg-white p-4 rounded-md shadow-sm border border-gray-100"
                                  >
                                    <div className="flex items-center mb-2">
                                      <div className="bg-gray-100 p-2 rounded-full mr-3">
                                        <IconUser size={18} className="text-gray-600" />
                                      </div>
                                      <div>
                                        <p className="font-medium text-gray-800">{member.name}</p>
                                        <p className="text-sm text-gray-500">{member.role}</p>
                                      </div>
                                    </div>
                                    <p className="text-gray-600 text-sm mt-2">{member.description}</p>
                                  </div>
                                ))}
                              </div>
                            </div>
                          )}

                          <div>
                            <h4 className="text-lg font-medium text-gray-800 mb-4 flex items-center border-b pb-2">
                              <IconTeam size={20} className="mr-2 text-gray-600" />
                              ユニット一覧
                            </h4>

                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 auto-rows-auto items-start">
                              {getTeamsBySectionId(section.id).map(team => (
                                <div 
                                  key={team.id}
                                  className={`bg-white rounded-lg border ${
                                    expandedTeams[team.id] 
                                      ? "border-teal-500 shadow-md" 
                                      : "border-gray-200 shadow-sm hover:shadow-md"
                                  } transition-all flex flex-col min-h-[140px]`}
                                >
                                  <div 
                                    className="p-4 cursor-pointer"
                                    onClick={() => toggleTeam(team.id)}
                                  >
                                    <div className="flex justify-between items-start">
                                      <div className="flex items-start">
                                        <div className={`p-2 rounded-full mr-3 ${expandedTeams[team.id] ? "bg-teal-100" : "bg-gray-100"}`}>
                                          <IconTeam size={18} className={`${expandedTeams[team.id] ? "text-teal-700" : "text-gray-600"}`} />
                                        </div>
                                        <div>
                                          <h5 className={`font-medium text-lg ${expandedTeams[team.id] ? "text-teal-700" : "text-gray-900"}`}>{team.name}</h5>
                                          <p className="text-base text-gray-600">
                                            ユニット長: {team.leader} ({team.members}名)
                                          </p>
                                        </div>
                                      </div>
                                      <IconChevronDown 
                                        size={16}
                                        className={`text-gray-500 transition-transform ${
                                          expandedTeams[team.id] ? "transform rotate-180" : ""
                                        }`}
                                      />
                                    </div>
                                  </div>

                                  {expandedTeams[team.id] && (
                                    <div className="px-4 pb-4 pt-1 border-t border-gray-100">
                                      <div className="mb-3">
                                        <p className="text-gray-700 text-base">{team.description}</p>
                                      </div>
                                      
                                      <div className="mt-4 pt-3 border-t border-gray-100">
                                        <div className="flex items-center">
                                          <div className="bg-blue-100 p-1.5 rounded-full mr-2">
                                            <IconManager size={14} className="text-blue-700" />
                                          </div>
                                          <div className="flex flex-col">
                                            <p className="text-base text-gray-700">マネージャー</p>
                                            <p className="text-base font-medium text-gray-800">{team.manager.name} ({team.manager.role})</p>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  )}
                                </div>
                              ))}
                            </div>
                          </div>
                        </div>
                      ))}

                      <div className="bg-gray-50 p-5 rounded-lg border border-gray-200 mt-8">
                        <h3 className="font-medium text-gray-800 mb-3 flex items-center">
                          <IconInfo size={20} className="mr-2 text-teal-600" />
                          組織体制について
                        </h3>
                        <p className="text-gray-700 mb-3">
                          各部署にはSMGが配置され、その下にMGとユニットが編成されています。
                          詳細な体制図は各部署のPDFリンクからご確認ください。
                        </p>
                        <p className="text-gray-700">
                          組織体制は定期的に見直されます。最新の情報は部内メールやイントラサイトでお知らせします。
                        </p>
                      </div>
                    </div>
                  )}

                  {activeTab === "announcements" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <IconInfo size={24} className="mr-3 text-teal-500" />
                        お知らせ一覧
                        <span className="ml-3 text-sm text-gray-500 font-normal">
                          (自動更新中: {new Date().toLocaleTimeString('ja-JP')})
                        </span>
                      </h2>
                      <div className="space-y-6">
                        {latestAnnouncements.map((announcement) => (
                          <div
                            key={announcement.id}
                            className="border-b pb-5 last:border-0 last:pb-0"
                          >
                            <div className="flex justify-between items-start">
                              <h3 className="font-semibold text-xl text-teal-700">
                                {announcement.title}
                              </h3>
                              <span className="text-sm text-gray-500">
                                {new Date(announcement.date).toLocaleString("ja-JP")}
                              </span>
                            </div>
                            <p className="text-gray-800 mt-3 text-base">
                              {announcement.content}
                            </p>
                            <div className="text-sm text-gray-600 mt-3">
                              投稿者: {announcement.author}
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {activeTab === "documents" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-6">文書一覧</h2>
                      <p className="text-lg text-gray-600 mb-8">
                        この機能は準備中です。しばらくお待ちください。
                      </p>
                      <div className="text-center py-12">
                        <IconFileText size={64} className="mx-auto text-gray-400" />
                        <p className="mt-4 text-lg text-gray-500">文書管理機能は現在開発中です。</p>
                      </div>
                    </div>
                  )}

                  {activeTab === "links" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <IconLink size={24} className="mr-3 text-teal-500" />
                        リンク集
                      </h2>

                      <div className="mb-8">
                        <div className="flex flex-col md:flex-row justify-between mb-6">
                          <div className="relative mb-4 md:mb-0 md:flex-grow md:max-w-md">
                            <input
                              type="text"
                              placeholder="リンクを検索..."
                              className="w-full py-2 px-4 pr-10 rounded-md border border-gray-300 text-base focus:outline-none focus:ring-2 focus:ring-teal-500"
                              value={linkSearchQuery}
                              onChange={(e) => setLinkSearchQuery(e.target.value)}
                            />
                            <div className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                              <IconSearch size={18} />
                            </div>
                          </div>
                        </div>

                        <div className="flex flex-wrap gap-2 mb-6">
                          {linkCategories.map((category) => (
                            <button
                              key={category.id}
                              className={`flex items-center px-4 py-2 rounded-full text-base font-medium ${
                                activeCategory === category.id
                                  ? "bg-teal-600 text-white"
                                  : "bg-gray-100 text-gray-700 hover:bg-gray-200"
                              }`}
                              onClick={() => setActiveCategory(category.id)}
                            >
                              <span className="mr-2">{category.icon}</span>
                              <span>{category.name}</span>
                            </button>
                          ))}
                        </div>
                      </div>

                      {activeCategory === 'all' ? (
                        <ul className="list-disc pl-6 space-y-2">
                          {getFilteredLinks().map(link => (
                            <li key={link.id} className="text-base">
                              <a href={link.url} target="_blank" rel="noreferrer" className="text-teal-700 hover:underline font-semibold">
                                {link.title}
                              </a>
                              <span className="ml-2 text-gray-600">{link.description}</span>
                            </li>
                          ))}
                        </ul>
                      ) : (
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                          {getFilteredLinks().map((link) => (
                            <a
                              key={link.id}
                              href={link.url}
                              className="group"
                              target="_blank"
                              rel="noreferrer"
                            >
                              <div className="border border-gray-200 rounded-lg overflow-hidden shadow-sm h-full hover:shadow-md transition-shadow flex flex-col">
                                <div className={`${link.color} px-3 py-2 flex items-center`}>
                                  <IconExternalLink size={16} className="mr-2 text-gray-700" />
                                  <h3 className="font-medium text-lg text-gray-900">{link.title}</h3>
                                </div>
                                <div className="p-3 flex-grow">
                                  <p className="text-lg text-gray-900">{link.description}</p>
                                </div>
                                <div className="px-3 py-2 bg-gray-50 border-t text-sm flex justify-between items-center">
                                  <span className="text-teal-700 group-hover:text-teal-800 font-medium">
                                    {linkCategories.find(c => c.id === link.category)?.name}
                                  </span>
                                  <span className="text-gray-600 flex items-center">
                                    <IconExternalLink size={14} className="mr-1" />
                                    開く
                                  </span>
                                </div>
                              </div>
                            </a>
                          ))}
                        </div>
                      )}

                      {getFilteredLinks().length === 0 && (
                        <div className="text-center py-12">
                          <IconSearch size={48} className="mx-auto text-gray-400" />
                          <p className="mt-4 text-lg text-gray-600">検索結果が見つかりませんでした。</p>
                          <p className="text-base text-gray-500">別のキーワードか、カテゴリで検索してください。</p>
                        </div>
                      )}
                    </div>
                  )}

                  {activeTab === "guide" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-8 flex items-center">
                        <IconGraduationCap size={24} className="mr-3 text-teal-500" />
                        新入社員ガイド
                      </h2>
                      
                      <p className="text-lg text-gray-700 mb-8 max-w-3xl">
                        新入社員の皆さん、ようこそ！こちらでは部内で使用する主要なシステムやツールの基本的な使い方を紹介します。
                        まずは以下のガイドを確認し、分からないことがあれば先輩社員やお問い合わせ窓口にご連絡ください。
                      </p>
                      
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
                        {newEmployeeGuides.map((guide) => (
                          <div key={guide.id} className="border border-gray-200 rounded-lg overflow-hidden shadow-md">
                            <div className={`${guide.color} px-6 py-5 flex items-center gap-4`}>
                              <div className="bg-white rounded-full p-3 shadow-md">
                                {guide.icon}
                              </div>
                              <h3 className="font-bold text-xl text-gray-900">{guide.title}</h3>
                            </div>
                            <div className="p-6">
                              <p className="text-lg text-gray-800 mb-5">{guide.description}</p>
                              <div className="bg-gray-50 p-4 rounded-md">
                                <h4 className="font-medium text-base text-gray-700 mb-3">手順概要</h4>
                                <ul className="space-y-2">
                                  {guide.steps.map((step, idx) => (
                                    <li key={idx} className="text-base text-gray-800">{step}</li>
                                  ))}
                                </ul>
                              </div>
                              
                              <div className="mt-5 text-right">
                                <a 
                                  href={guide.url} 
                                  className="inline-flex items-center text-base font-medium text-teal-600 hover:text-teal-800"
                                  target="_blank"
                                  rel="noreferrer"
                                >
                                  詳細を見る <IconChevronRight size={16} className="ml-1" />
                                </a>
                              </div>
                            </div>
                          </div>
                        ))}
                      </div>
                      
                      <div className="bg-teal-50 rounded-lg p-6 border border-teal-100">
                        <h3 className="text-xl font-bold text-teal-700 mb-4 flex items-center">
                          <IconInfo size={22} className="mr-2" />
                          サポート体制
                        </h3>
                        <p className="text-lg text-gray-800 mb-4">
                          新入社員の方は、配属後3ヶ月間メンターがサポートします。
                          システムの使い方や業務に関する質問があれば、遠慮なくメンターや周囲の先輩社員に相談してください。
                        </p>
                        <div className="flex flex-col md:flex-row md:items-center gap-4 md:gap-8 mt-4">
                          <a 
                            href="#" 
                            className="bg-teal-600 text-white px-6 py-3 rounded-md font-medium text-base hover:bg-teal-700 transition-colors flex items-center justify-center"
                          >
                            <IconMessageSquare size={18} className="mr-2" />
                            メンターに問い合わせる
                          </a>
                          <a 
                            href="#" 
                            className="bg-white text-teal-600 border border-teal-600 px-6 py-3 rounded-md font-medium text-base hover:bg-teal-50 transition-colors flex items-center justify-center"
                          >
                            <IconHelpCircle size={18} className="mr-2" />
                            よくある質問を見る
                          </a>
                        </div>
                      </div>
                    </div>
                  )}

                  {activeTab === "misc" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <IconMoreHorizontal size={24} className="mr-3 text-teal-500" />
                        その他
                      </h2>

                      <div className="mb-10">
                        <div className="flex justify-between items-center border-b border-gray-200 pb-4 mb-6">
                          <h3 className="text-xl font-bold text-gray-800 flex items-center">
                            <IconImprovement size={24} className="mr-3 text-teal-600" />
                            小変活動の記録
                          </h3>
                          <div className="flex space-x-2">
                            {Object.keys(kaizenActivities).map(year => (
                              <button
                                key={year}
                                className={`px-4 py-2 rounded-md text-base font-medium transition-colors ${
                                  activeKaizenYear === year 
                                    ? "bg-teal-600 text-white" 
                                    : "bg-gray-100 text-gray-700 hover:bg-gray-200"
                                }`}
                                onClick={() => setActiveKaizenYear(year)}
                              >
                                {year}年度
                              </button>
                            ))}
                          </div>
                        </div>
                        
                        <p className="text-lg text-gray-700 mb-6">
                          新人社員が中心となって取り組んだ小変活動（改善活動）の記録です。業務効率化や職場環境の改善に貢献したプロジェクトをご覧いただけます。
                        </p>

                        <div className="grid grid-cols-1 gap-8">
                          {kaizenActivities[activeKaizenYear]?.map((activity) => (
                            <div key={activity.id} className="border border-gray-200 rounded-lg overflow-hidden shadow-md">
                              <div className="bg-teal-50 p-5 border-b border-gray-200 flex justify-between items-start">
                                <div className="flex flex-col">
                                  <h4 className="font-bold text-xl text-gray-900">{activity.title}</h4>
                                  <div className="flex items-center mt-2 text-base text-gray-600">
                                    <span className="font-medium mr-2">{activity.team}</span>
                                    <span>チームメンバー: {activity.members.join(', ')}</span>
                                  </div>
                                </div>
                                <div className="flex flex-wrap gap-2">
                                  {activity.technologies.map((tech, idx) => (
                                    <span 
                                      key={idx}
                                      className="inline-flex px-2.5 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800"
                                    >
                                      {tech}
                                    </span>
                                  ))}
                                </div>
                              </div>
                              
                              <div className="p-5">
                                <div className="flex flex-col md:flex-row gap-6">
                                  <div className="md:w-3/5">
                                    <h5 className="font-medium text-lg text-gray-800 mb-3">プロジェクト概要</h5>
                                    <p className="text-base text-gray-800 mb-5">{activity.description}</p>
                                    
                                    <h5 className="font-medium text-lg text-gray-800 mb-3">成果</h5>
                                    <p className="text-base text-gray-800">{activity.results}</p>
                                  </div>
                                  
                                  <div className="md:w-2/5">
                                    <div className="rounded-lg overflow-hidden border border-gray-200">
                                      <img 
                                        src={activity.image}
                                        alt={activity.title}
                                        className="w-full h-60 object-cover"
                                      />
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                        
                        <p className="text-base text-gray-600 mt-6">
                          ※小変活動は継続的な改善の一環として、各年度に新入社員を中心に取り組まれています。過去の事例を参考にして、今後の改善活動にぜひご活用ください。
                        </p>
                      </div>
                    </div>
                  )}

                  {activeTab === "construction" && (
                    <div className="bg-white rounded-lg shadow-md p-6">
                      <h2 className="text-2xl font-bold text-gray-800 mb-6">
                        {constructionTarget}
                      </h2>
                      {constructionTarget === "大阪" ? (
                        <div className="space-y-6">
                          <div className="border border-gray-200 rounded-lg overflow-hidden shadow-md">
                            <img src={osakaActivity.image} alt={osakaActivity.title} className="w-full h-56 object-cover" />
                            <div className="p-6">
                              <h3 className="font-bold text-xl text-gray-900 mb-3 flex items-center">
                                <IconImprovement size={22} className="mr-3 text-teal-600" />
                                {osakaActivity.title}
                              </h3>
                              <p className="text-base text-gray-800 mb-4">{osakaActivity.summary}</p>
                              <h4 className="font-medium text-lg text-gray-800 mb-2">成果</h4>
                              <p className="text-base text-gray-800">{osakaActivity.impact}</p>
                            </div>
                          </div>
                        </div>
                      ) : (
                        <>
                          <p className="text-lg text-gray-600 mb-8">
                            この機能は準備中です。しばらくお待ちください。
                          </p>
                          <div className="text-center py-12">
                            <IconSettings size={64} className="mx-auto text-gray-400" />
                            <p className="mt-4 text-lg text-gray-500">
                              {constructionTarget}は現在開発中です。近日公開予定です。
                            </p>
                          </div>
                        </>
                      )}
                    </div>
                  )}

                  {activeTab === "search-results" && searchResults && (
                    <div className="space-y-8 bg-white rounded-lg shadow-md p-8">
                      <div className="border-b pb-5 mb-6">
                        <h2 className="text-2xl font-bold text-gray-800 mb-3 flex items-center">
                          <IconSearch size={26} className="mr-4 text-teal-500" />
                          「{searchQuery}」の検索結果
                        </h2>
                        <p className="text-base text-gray-600">
                          {Object.values(searchResults).reduce((acc, curr) => acc + curr.length, 0)} 件のコンテンツが見つかりました
                        </p>
                      </div>

                      {searchResults.announcements.length > 0 && (
                        <div className="mb-10">
                          <h3 className="text-xl font-medium text-gray-800 mb-5 flex items-center border-b pb-3">
                            <IconInfo className="mr-3 text-teal-500" size={20} />
                            お知らせ ({searchResults.announcements.length}件)
                          </h3>
                          <div className="space-y-4">
                            {searchResults.announcements.map((item) => (
                              <div key={item.id} className="bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors">
                                <div className="flex justify-between items-start">
                                  <h4 className="font-medium text-lg text-teal-700">{item.title}</h4>
                                  <span className="text-sm text-gray-500">{formatDate(item.date)}</span>
                                </div>
                                <p className="text-base text-gray-800 mt-2">{item.content}</p>
                                <p className="text-sm text-gray-600 mt-2">投稿者: {item.author}</p>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}

                      {Object.values(searchResults).every(arr => arr.length === 0) && (
                        <div className="text-center py-12">
                          <div className="text-7xl mb-6">🔍</div>
                          <h3 className="text-2xl font-medium text-gray-700 mb-3">検索結果が見つかりませんでした</h3>
                          <p className="text-lg text-gray-600 mb-6">検索キーワードを変更して再度お試しください</p>
                        </div>
                      )}
                    </div>
                  )}
                </main>
              </div>

              {/* Footer */}
              <footer className="bg-gray-100 py-8 mt-auto border-t border-gray-200">
                <div className="container mx-auto px-6 flex flex-col md:flex-row md:justify-between items-center">
                  <div className="text-center md:text-left mb-6 md:mb-0">
                    <h3 className="font-bold text-lg text-gray-800 mb-2">お問い合わせ</h3>
                    <div className="flex flex-col gap-1">
                      <p className="text-base text-gray-600 flex items-center justify-center md:justify-start">
                        <span className="font-medium mr-2 text-gray-500">内線:</span> 1234
                      </p>
                      <p className="text-base text-gray-600 flex items-center justify-center md:justify-start">
                        <span className="font-medium mr-2 text-gray-500">メール:</span> tech-dept@example.com
                      </p>
                    </div>
                  </div>

                  <div className="flex items-center">
                    <a 
                      href="https://docs.google.com/forms/d/e/1FAIpQLSdwKjrCwu2U4DTmgd6uuW2AtaoQ9s2S6FFHTnx0c0JAQFIEyQ/viewform?usp=header" 
                      className="px-6 py-2 bg-teal-600 hover:bg-teal-700 text-white font-bold rounded shadow transition-colors duration-200"
                      target="_blank" 
                      rel="noreferrer"
                    >
                      修正・改善依頼フォームはこちら
                    </a>
                  </div>
                </div>
                
                <div className="mt-8 text-center border-t border-gray-200 pt-6">
                  <p className="text-xs text-gray-400">© 2024 システム開発部門</p>
                </div>
              </footer>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<DepartmentIntranet />);
    </script>
</body>
</html>
